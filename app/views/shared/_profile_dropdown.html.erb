<div class="relative z-[9999]" data-controller="dropdown">
  <!-- Profile Picture Button -->
  <button 
    type="button"
    class="flex items-center focus:outline-none"
    data-action="click->dropdown#toggle"
  >
    <% if current_user.profile_photo.attached? %>
      <%= image_tag current_user.profile_photo.variant(resize_to_fill: [40, 40]),
                    class: "h-10 w-10 rounded-full object-cover border border-gray-300" %>
    <% else %>
      <div class="h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center">
        <span class="text-gray-600 font-bold">
          <%= current_user.name&.first&.upcase || "U" %>
        </span>
      </div>
    <% end %>
  </button>

  <!-- Dropdown Menu -->
  <div 
    data-dropdown-target="menu"
    class="hidden absolute right-0 mt-2 w-48 bg-white left-0 rounded-md shadow-lg z-50 sm:right-0 sm:left-auto left-1/2 -translate-x-1/2">
    <div class="px-4 py-3 border-b">
      <p class="font-semibold"><%= current_user.name || "No Name" %></p>
      <p class="text-xs text-gray-500"><%= current_user.email %></p>
    </div>

    <%= link_to profile_path, data: { turbo_frame: "_top" }, class: "flex items-center gap-2 px-4 py-2 hover:bg-gray-100 text-sm" do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A9.004 9.004 0 0112 15c2.485 0 4.735.995 6.379 2.621M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
      My Profile
    <% end %>

    <%= link_to new_product_path, data: { turbo_frame: "_top" }, class: "flex items-center gap-2 px-4 py-2 hover:bg-gray-100 text-sm" do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.5v15m7.5-7.5h-15" />
      </svg>
      Add Product
    <% end %>

    <%= link_to destroy_user_session_path,
                data: { turbo_method: :delete, turbo_frame: "_top" },
                class: "flex items-center gap-2 px-4 py-2 hover:bg-red-50 text-sm text-red-600" do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
      </svg>
      Sign Out
    <% end %>
  </div>
</div>
